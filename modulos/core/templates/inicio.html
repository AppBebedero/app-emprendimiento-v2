{% extends 'base.html' %}

{% block title %}Inicio{% endblock %}
{% block topbar_title %}{{ config.get('NombreNegocio', 'Mi Emprendimiento') }}{% endblock %}

{% block content %}
<div class="container mt-4">
  <!-- Ejemplo: Barra superior con logo y nombre -->
  <header class="d-flex align-items-center py-3" style="background: var(--color-topbar, #0d6efd);">
    <img id="logo-inicio" src="{{ config.get('LogoURL', '') }}" alt="Logo" width="40" class="me-3">
    <h1 class="nombre-negocio m-0 text-white">{{ config.get('NombreNegocio', 'Mi Emprendimiento') }}</h1>
  </header>

  <!-- Tu contenido actual aquí -->
  <div class="mt-4">
    <!-- ... -->
  </div>
</div>

<style>
  :root {
    --color-topbar: {{ config.get('ColorPrincipal', '#0d6efd') }};
    --color-bottombar: {{ config.get('ColorFondo', '#ffffff') }};
  }
</style>

<script>
// Escuchar cambios desde Configuración
window.addEventListener('message', (event) => {
  if (event.data && event.data.type === 'configUpdated') {
    updateUI(event.data.config);
  }
});

// Cargar configuración al iniciar
document.addEventListener('DOMContentLoaded', () => {
  const savedConfig = JSON.parse(localStorage.getItem('appConfig')) || {};
  if (Object.keys(savedConfig).length > 0) {
    updateUI(savedConfig);
  }
});

// Actualizar interfaz
function updateUI(config) {
  // Actualizar nombre
  const nombreElement = document.querySelector('.nombre-negocio');
  if (nombreElement) nombreElement.textContent = config.NombreNegocio || 'Mi Emprendimiento';
  
  // Actualizar colores
  document.documentElement.style.setProperty('--color-topbar', config.ColorPrincipal || '#0d6efd');
  document.documentElement.style.setProperty('--color-bottombar', config.ColorFondo || '#ffffff');
  
  // Actualizar logo
  const logoElement = document.getElementById('logo-inicio');
  if (logoElement && config.LogoURL) {
    logoElement.src = config.LogoURL;
  }
}
</script>
{% endblock %}
